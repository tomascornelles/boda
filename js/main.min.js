function initMap(){var a=[{stylers:[{hue:"#F39C12"},{saturation:20}]},{featureType:"road",elementType:"all",stylers:[{lightness:100}]}],s=new google.maps.StyledMapType(a,{name:"Styled Map"}),e={zoom:16,center:{lat:41.3890643,lng:2.167363},scrollwheel:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]},disableDefaultUI:!0},o=new google.maps.Map(document.getElementById("map"),e);o.mapTypes.set("map_style",s),o.setMapTypeId("map_style");var t={title:"Hotel Avenida Palace",coords:new google.maps.LatLng(41.3890643,2.167363),description:'<h4>Hotel Avenida Palace</h4><p><strong>Dirección:</strong><br>Gran Via de Les Corts Catalanes, 605, 08007 Barcelona</p><p><strong>Horario: </strong><br>Fotos: 19:00h<br>Ceremonia: 19:30h<br>Recepción: 21:00h</p><p><a href="https://www.google.es/maps/dir//Hotel+Avenida+Palace,+Gran+Via+de+Les+Corts+Catalanes,+605,+08007+Barcelona/@41.3890643,2.1651743,17z/data=!4m13!1m4!3m3!1s0x12a4a2f257ed123f:0xd0526acc9f673041!2sHotel+Avenida+Palace!3b1!4m7!1m0!1m5!1m1!1s0x12a4a2f257ed123f:0xd0526acc9f673041!2m2!1d2.167363!2d41.3890643" target="_blank" class="button u-full-width">¿Como llegar?</a></p>',icono:"img/palace64.png"},i=new google.maps.InfoWindow({content:t.description}),r=new google.maps.Marker({position:t.coords,map:o,title:t.title,icon:t.icono});r.addListener("click",function(){i.open(o,r)})}function InvitadoCargar(a,s){var e;a.admin?(e={admin:!0},localStorage.setItem("datos",JSON.stringify(e)),page("/admin")):(e={id:s,pass:a.pass,nombre:a.nombre,email:a.email,adultos:a.adultos,ninos:a.ninos,comida:a.comida,mensaje:a.mensaje,confirmar:a.confirmar,canciones:a.canciones,chara:a.chara},localStorage.setItem("datos",JSON.stringify(e)),page("/invitado"))}function InvitadoMostrar(){var a=JSON.parse(localStorage.datos);$(".Invitado-nombre").text(a.nombre),void 0!==a.confirmar?($(".Invitado-noConfirma").hide(),$(".Invitado-confirmado").show(),void 0!==a.mensaje?$('.button[data-destino=".Invitado-contenido-mensaje"]').hide():$('.button[data-destino=".Invitado-contenido-mensaje"]').closest(".six").removeClass("six").addClass("twelve"),$(".Invitado--cargando").hide(),$(".Invitado-contenido").fadeIn(),$(".Invitado").fadeIn(1e3)):($(".Invitado--cargando").hide(),$(".Invitado-contenido").fadeIn(),$(".Invitado").fadeIn(1e3))}function InvitadoGuardar(a){var s=JSON.parse(localStorage.datos),e=a.attr("data-parametro"),o="";$(".checked[data-parametro="+e+"]").each(function(){o&&(o+=", "),o+=$(this).text()}),s[e]=o,localStorage.setItem("datos",JSON.stringify(s)),new Firebase("https://boda201610.firebaseio.com/").child(s.id).set(s)}function InvitadoMensaje(){var a=JSON.parse(localStorage.datos);a.mensaje=$(".Invitado-mensaje-texto").val(),localStorage.setItem("datos",JSON.stringify(a)),new Firebase("https://boda201610.firebaseio.com/").child(a.id).set(a)}function InvitadoConfirmar(){var a=JSON.parse(localStorage.datos);a.confirmar="Confirmado",localStorage.setItem("datos",JSON.stringify(a)),new Firebase("https://boda201610.firebaseio.com/").child(a.id).set(a)}function Login(a){var s=a.params.pass;$(".Login-form").on("submit",function(a){a.preventDefault(),page("/invitado/"+$(".Login-llave").val())}),s?"error"===s?(PaginaLogin(),$(".Login-noPass").fadeIn(500)):(s=parseInt(s),localStorage.removeItem("datos"),new Firebase("https://boda201610.firebaseio.com/").orderByChild("pass").equalTo(s).once("value",function(a){if(a.val()){var s=a.val();for(var e in s){var o=s[e];InvitadoCargar(o,e)}}else page("/invitado/error")})):localStorage.datos?PaginaInvitado():PaginaLogin()}function Logout(){localStorage.removeItem("datos"),$(".checked").removeClass("checked"),page("/home")}function LoginCervero(a){localStorage.datos||(window.location.href="./");var s=JSON.parse(localStorage.datos);"admin"!==a||s.admin||(window.location.href="./")}function MusicaPlaylist(){var a=JSON.parse(localStorage.datos);if(a.canciones){$(".Musica-mis-resultados").empty();for(var s=a.canciones.split(", "),e=0;e<s.length;e++){var o="https://api.spotify.com/v1/tracks/"+s[e];$.get(o,function(a){var s='<div class="Musica-resultado u-cf"><a data-cancion="'+a.id+'" class="Musica-resultado-remove"></a><div class="Musica-resultado-imagen"><img src="'+a.album.images[0].url+'" alt=""></div><h4 class="Musica-resultado-nombre">'+a.name+' <a href="'+a.preview_url+'" target="_blank" style="text-decoration: none;">▶</a></h4><div class="Musica-resultado-artista">'+a.artists[0].name+'</div><div class="Musica-resultado-album">'+a.album.name+"</div></div>";$(".Musica-mis-resultados").append(s),$(".Musica-resultado-add").on("click",MusicaGuardar),$(".Musica-resultado-remove").on("click",MusicaBorrar)})}}else $(".Musica-mis-resultados").html("<h3>¿Nos ayudas con la música de la fiesta?</h3><p>¡Sugierenos las canciones que más te gusten!</p>");$(".Musica").fadeIn(1e3)}function MusicaBuscar(){var a="https://api.spotify.com/v1/search?query="+$(this).val()+"&offset=0&limit=20&type=track";$.get(a,function(a){$(".Musica-resultados").empty();for(var s=0;s<a.tracks.items.length;s++){var e=a.tracks.items[s],o=JSON.parse(localStorage.datos),t="Musica-resultado-add";o.canciones&&-1!==o.canciones.indexOf(e.id)&&(t="Musica-resultado-remove");var i='<div class="Musica-resultado u-cf"><a data-cancion="'+e.id+'" class="'+t+'"></a><div class="Musica-resultado-imagen"><img src="'+e.album.images[0].url+'" alt=""></div><h4 class="Musica-resultado-nombre">'+e.name+' <a href="'+e.preview_url+'" target="_blank" style="text-decoration: none;">▶</a></h4><div class="Musica-resultado-artista">'+e.artists[0].name+'</div><div class="Musica-resultado-album">'+e.album.name+"</div></div>";$(".Musica-resultados").append(i)}$(".Musica-resultado-add").on("click",MusicaGuardar),$(".Musica-resultado-remove").on("click",MusicaBorrar)})}function MusicaGuardar(){var a=JSON.parse(localStorage.datos),s="canciones",e=$(this).attr("data-cancion");$(this).addClass("Musica-resultado-remove").removeClass("Musica-resultado-add"),a[s]?a[s]+=", "+e:a[s]=e,$(".Musica-volver").slideDown(),localStorage.setItem("datos",JSON.stringify(a)),new Firebase("https://boda201610.firebaseio.com/").child(a.id).set(a),$(".Musica-resultado-remove").on("click",MusicaBorrar)}function MusicaBorrar(){var a=JSON.parse(localStorage.datos),s="canciones",e=$(this).attr("data-cancion");$(this).addClass("Musica-resultado-add").removeClass("Musica-resultado-remove");var o=a.canciones.split(", ");a[s]="";for(var t=0;t<o.length;t++)a[s]&&o[t]!==e?a[s]+=", "+o[t]:o[t]!==e&&(a[s]=o[t]);localStorage.setItem("datos",JSON.stringify(a)),new Firebase("https://boda201610.firebaseio.com/").child(a.id).set(a),$(".Musica-resultado-add").on("click",MusicaGuardar)}function CharaMaker(){var a=["#efbe92","#402420","#000000","#c22b2a","#004584","#402420"],s={svg_body:a[0],svg_hair:a[1],svg_beard:"transparent",svg_mustache:"transparent",svg_eyes:a[2],svg_shirt:a[3],svg_pants:a[4],svg_shoes:a[5],svg_shirt_chaleco:"transparent",svg_shirt_tirantes:"transparent",svg_shirt_rayas:"transparent",svg_shirt_flash:"transparent",hairType:"corto",pantType:"largo"};if(localStorage.datos){var e=JSON.parse(localStorage.datos);e.chara?s=e.chara:e.chara=s}$(".svg_body").css({fill:s.svg_body}),$(".svg_hair").css({fill:s.svg_hair}).hide(),"corto"===s.hairType?$(".svg_hair_corto").show():$(".svg_hair_largo").show(),$(".svg_beard").css({fill:s.svg_beard}),$(".svg_mustache").css({fill:s.svg_mustache}),$(".svg_eyes").css({fill:s.svg_eyes}),$(".svg_shirt").css({fill:s.svg_shirt}).hide(),$(".svg_shirt_corto").show(),$(".svg_shirt_chaleco").css({fill:s.svg_shirt_chaleco}),$(".svg_shirt_tirantes").css({fill:s.svg_shirt_tirantes}),$(".svg_shirt_rayas").css({fill:s.svg_shirt_rayas}),$(".svg_shirt_flash").css({fill:s.svg_shirt_flash}),$(".svg_pants").css({fill:s.svg_pants}).hide(),"falda"===s.pantType?$(".svg_pants_falda").show():"corto"===s.pantType?$(".svg_pants_corto").show():$(".svg_pants_largo").show(),$(".svg_shoes").css({fill:s.svg_shoes});var o=[];o[".svg_hair"]="corto",o[".svg_pants"]="largo",$(".elije-color").on("click",function(){var a=$(this).attr("data-parte");if(CharaColores(a,s),$(".Chara-opciones .opciones").empty(),$(this).attr("data-tipos")){for(var e=$(this).attr("data-tipos"),o=e.split(" "),t=0;t<o.length;t++)$(".Chara .opciones").append('<a data-tipo="'+o[t]+'" class="button opcion">'+o[t]+"</a> ");$(".opcion").on("click",function(){"svg_hair"===a?s.hairType=$(this).attr("data-tipo"):s.pantType=$(this).attr("data-tipo"),"falda"===$(this).attr("data-tipo")&&$('.elije-color[data-parte="svg_pants"]').text("Falda"),("corto"===$(this).attr("data-tipo")||"largo"===$(this).attr("data-tipo"))&&$('.elije-color[data-parte="svg_pants"]').text("Pantalón"),$("."+a).hide();var e="."+a+"_"+$(this).attr("data-tipo");$(e).show(),"falda"===s.pantType&&"largo"===s.hairType?($(".Chara .svg_base, .Chara .svg_sombra").css({fill:"transparent",stroke:"transparent"}),$(".Chara .svg_base.svg_base_pelo_falda").css({fill:"#000",stroke:"#000"}),$(".Chara .svg_sombra.svg_base_pelo_falda").css({fill:"rgba(0,0,0,.5)"})):"falda"===s.pantType&&"largo"!==s.hairType?($(".Chara .svg_base, .Chara .svg_sombra").css({fill:"transparent",stroke:"transparent"}),$(".Chara .svg_base.svg_base_falda").css({fill:"#000",stroke:"#000"}),$(".Chara .svg_sombra.svg_base_falda").css({fill:"rgba(0,0,0,.5)"})):"falda"!==s.pantType&&"largo"===s.hairType?($(".Chara .svg_base, .Chara .svg_sombra").css({fill:"transparent",stroke:"transparent"}),$(".Chara .svg_base.svg_base_pelo").css({fill:"#000",stroke:"#000"}),$(".Chara .svg_sombra.svg_base_pelo").css({fill:"rgba(0,0,0,.5)"})):($(".Chara .svg_base, .Chara .svg_sombra").css({fill:"transparent",stroke:"transparent"}),$(".Chara .svg_base.svg_base_hombre").css({fill:"#000",stroke:"#000"}),$(".Chara .svg_sombra.svg_base_hombre").css({fill:"rgba(0,0,0,.5)"}))})}$(".Chara .partes").hide(),$(".Chara-opciones").slideDown()})}function CharaColores(a,s){var e=["transparent","#efbe92","#edb69f","#c0642e","#8b391e","#402420","#000000","#ffffff","#ffefbd","#ffc500","#e45214","#c22b2a","#ff8ea4","#693d9f","#004584","#007ebe","#0f8a49","#5ccf97","#182c1d","#ca1146","#5a0b15","#67a9bf","#8e9397"];$(".Chara-opciones .colores").empty();for(var o=0;o<e.length;o++)"transparent"===e[o]?$(".Chara .colores").append('<a data-color="'+e[o]+'" style="background-color:'+e[o]+'" class="button color">Borrar</a> <br>'):$(".Chara .colores").append('<a data-color="'+e[o]+'" style="background-color:'+e[o]+'" class="button color"></a> '),o%6===0&&$(".Chara .colores").append("<br>");$(".Chara .colores").append('<br><a class="button color">Cerrar</a> <br>'),$(".color").on("click",function(){if($(this).attr("data-color")&&$("."+a).css({fill:$(this).attr("data-color")}),$(".Chara-opciones").hide(),$(".Chara .partes").fadeIn(),s[a]=$(this).attr("data-color"),localStorage.datos){var e=JSON.parse(localStorage.datos);e.chara=s,localStorage.setItem("datos",JSON.stringify(e)),new Firebase("https://boda201610.firebaseio.com/").child(e.id).set(e)}})}function toggleDestino(){$($(this).attr("data-destino")).siblings(".Page-section").slideUp(400),$($(this).attr("data-destino")).slideDown(400)}function toggleButton(){$(this).hasClass("checked")?$(this).removeClass("checked"):$(this).addClass("checked").siblings(".button-radio").removeClass("checked"),InvitadoGuardar($(this))}function checkButton(){$(this).toggleClass("checked"),InvitadoGuardar($(this))}function PaginaLimpia(){$(".Page").hide(),$(".Page-section").hide(),$(".error").hide(),$(".Musica-resultados").empty(),$(".Musica-input").val(""),$(".Menu .u-desktop").css({display:""}),$(".Menu a").show(),localStorage.datos||$(".cervero").hide(),$(".Invitado--cargando").show(),$(".Invitado-contenido-botones").show()}function PaginaHome(){PaginaLimpia(),$(".Home").fadeIn(1e3)}function PaginaChara(){PaginaLimpia(),CharaMaker(),$(".Chara").fadeIn(1e3)}function PaginaMapa(){LoginCervero(),PaginaLimpia(),$(".Mapa").fadeIn(1e3),initMap()}function PaginaInvitado(){LoginCervero(),PaginaLimpia(),InvitadoMostrar()}function PaginaLogin(){PaginaLimpia(),$(".Login").fadeIn(1e3)}function PaginaMusica(){LoginCervero(),PaginaLimpia(),MusicaPlaylist()}function PaginaMusicaBuscar(){LoginCervero(),PaginaLimpia(),$(".Musica-Buscar").fadeIn(1e3)}function Pagina404(){PaginaLimpia(),$(".Error404").fadeIn(1e3)}$(function(){$(window).on("resize",function(){initMap(),$(".Menu .u-desktop").css({display:""})}),$(".Menu-toggle").on("click",function(){$(".Menu .u-desktop").slideToggle()}),$(".button-submit").on("click",toggleDestino),$(".button-radio").on("click",toggleButton),$(".button-check").on("click",checkButton),$(".Invitado-mensaje-enviar").on("click",InvitadoMensaje),$(".Invitado-confirmar-enviar").on("click",InvitadoConfirmar),$(".Musica-input").on("keyup",MusicaBuscar),page.base("/boda"),page("/",PaginaHome),page("/home",PaginaHome),page("/dibuja",PaginaChara),page("/informacion",PaginaMapa),page("/invitado",Login),page("/invitado/:pass",Login),page("/salir",Logout),page("/musica",PaginaMusica),page("/buscarmusica",PaginaMusicaBuscar),page("/*",Pagina404),page({hashbang:!0})});